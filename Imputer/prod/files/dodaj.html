<!DOCTYPE html>
<html>
<head>
	<title>Dodaj</title>
	<link rel="stylesheet" type="text/css" href="bulma.css">

	<style type="text/css">
		.nav { position: fixed !important; top: 0; left: 0; right: 0; }
	</style>
	<style type="text/css">
		.empty
		{
			height: 52px;
		}
		.inputfile
		{
			width: 0.1px;
			height: 0.1px;
			opacity: 0;
			overflow: hidden;
			position: absolute;
			z-index: -1;
		}

	</style>
	<script src="jquery.js"></script>
	<script type="text/javascript">

	</script>
</head>
<body>
	<div class="container">
		<nav class="nav has-shadow">
			<div class="container">
				<div class="nav-left">
					<a class="nav-item">
						<img src="logo.png" alt="Evinser logo">
					</a>
					<a href="/view/" class="nav-item is-tab is-hidden-mobile is-active">Menu</a>
					<a href="/add/" class="nav-item is-tab is-hidden-mobile">Dodaj</a>
					<a class="nav-item is-tab is-hidden-mobile">Udostepnij</a>
					<a class="nav-item is-tab is-hidden-mobile">Kontakt</a>
				</div>
				<span class="nav-toggle">
					<span></span>
					<span></span>
					<span></span>
				</span>
				<div class="nav-right nav-menu">
					<a class="nav-item is-tab is-hidden-tablet is-active">Menu</a>
					<a class="nav-item is-tab is-hidden-tablet">Dodaj</a>
					<a class="nav-item is-tab is-hidden-tablet">Udostepnij</a>
					<a class="nav-item is-tab is-hidden-tablet">About</a>
                    <a class="nav-item is-tab">Zaznaczone!</a>
					<!--<a class="nav-item is-tab">-->
						<!--<figure class="image is-16x16" style="margin-right: 8px;">-->
							<!--<img src="http://bulma.io/images/jgthms.png">-->
						<!--</figure>-->
						<!--Profil-->
					<!--</a>-->
				</div>
			</div>
		</nav>
        <div class="tabs is-small">

	</div>
	<div class="empty"></div>

	<section class="section">
		<div class="container ">
			<h1 class="title">Dodawanie</h1>
			<h2 class="subtitle">
				<p class="is-large">Aby dodać nowe obrazki, możesz przeszukać bazy stworzone
                    już przez innych użytkowników, bądź dodać je z komputera. Do podglądu obrazki mają zmiejszoną jakość</p>
                <form id="upload-file" method="post" enctype="multipart/form-data">
				<p id="attachments_button" class="has-text-centered">
					<label class="button">

						<input id="attachments" type="file" name="files[]" accept="image/*" class="inputfile"  data-multiple-caption="{count} obrazki wybrane" multiple />
						<span id="desc">Wybierz z dysku</span>

					</label>
				</p>
                </form>
				 
			</h2>

            <div>
                <nav class="level" id="edit_menu_online">
				<!-- Left side -->
				<div class="level-left">
					<div class="level-item">
						<p class="subtitle is-5">
							<strong>123</strong> Obrazków
						</p>
					</div>
					<div class="level-item">
						<div class="field has-addons">
							<p class="control">
								<input class="input" type="text" placeholder="Poszukaj obrazków">
							</p>
							<p class="control">
								<button class="button">
									SzukajCHUJ
								</button>
							</p>
						</div>
					</div>
				</div>
<!-- Right side -->
				<div class="level-right">
					<p class="level-item"><a class="button is-primary">Pojedyńcze obrazki</a></p>
					<p class="level-item"><a class="button">Całe bazy</a></p>
					<p class="level-item"><a class="button">Po ID bazy</a></p>

				</div>
			</nav>
            </div>

            <div class="hide" id="edit_menu_local">
                <div class="columns">
                    <div class="column is-one-quarter"></div>
                    <div class="column">
                        <p>
                            Pamiętaj, że możesz przypisać wszystkim obrazą wspólny tak klikająć zakładkę `zaznaczone`.
                        </p>
                    </div>
                    <div class="column is-one-quarter"></div>
                </div>
            </div>
            <output></output>
		</div>
	</section>
	<script type="text/javascript">
		var inputs = document.querySelectorAll( '.inputfile' );
		Array.prototype.forEach.call( inputs, function( input )
		{
			var label	 = input.nextElementSibling,
				labelVal = label.innerHTML;
			
			input.addEventListener( 'change', function( e )
			{

				var fileName = '';
				if( this.files && this.files.length > 1 )
					fileName = ( this.getAttribute( 'data-multiple-caption' ) || '' ).replace( '{count}', this.files.length );
				else
					fileName = e.target.value.split( '\\' ).pop();
				if( fileName )
				{
					var el = document.getElementById( 'desc' );
					label.parentElement.classList.add('is-primary');
					label.innerHTML = fileName;
				}
				else
					label.innerHTML = labelVal;
			});
		});
	</script>
        <script>
            function send_data(data, site) {
        $.ajax({
            url: "http://localhost:5000/" + site,
            type: "POST",
            processData: false,
            cache: false,
            data: JSON.stringify(data, null, '\t'),
            contentType: 'application/json;charset=UTF-8',
            success: function(result) {
                console.log(result);
            }
        });

            }
        </script>

	<script type="text/javascript">

   $('#attachments').change(function(){
var formData = new FormData($("#upload-file")[0]);
        $.ajax({
            url: "http://localhost:5000/upload_files/",
            type: "POST",
            data: formData,
            processData: false,
            contentType: false,
            cache: false,
            success: function(result){

            $('output').append(result);
            $('#edit_menu_online').addClass('hide');
            $('#edit_menu_local').removeClass('hide');
            $('#attachments_button').addClass('hide');
           }
        });
        });
	</script>
    <script>
    $('output').on('click', '.delete-bt', function () {
        $(this).parent().parent().addClass('hide');
		alert('elo');
        var data = {'id': $(this).parent().attr('id'), 'action':'delete', 'mode': 'selected'};
        send_data(data, 'change_state/');
    })
    </script>
</body>
</html>